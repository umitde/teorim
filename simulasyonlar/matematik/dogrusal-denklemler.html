<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doğrusal Denklemler | Teorim</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-app: #f8fafc;
            --bg-panel: #ffffff;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --col-accent: #f97316; /* Teorim Turuncusu */
            
            /* Grafik Renkleri */
            --col-line: #3b82f6;   /* Doğru - Mavi */
            --col-slope: #a855f7;  /* Eğim - Mor */
            --col-yint: #f59e0b;   /* Y Kesişim - Turuncu */
            --col-xint: #ef4444;   /* X Kesişim - Kırmızı */
            
            --border: #e2e8f0;
            --radius: 16px;
        }

        body { 
            margin: 0; padding: 0; background: var(--bg-app); 
            color: var(--text-main); font-family: 'Inter', sans-serif; 
            height: 100vh; display: flex; overflow: hidden; 
            -webkit-font-smoothing: antialiased;
        }

        /* --- MOBİL UYARI --- */
        #mobile-warning { 
            display: none; position: fixed; inset: 0; background: #0f172a; color: white; 
            z-index: 9999; flex-direction: column; align-items: center; justify-content: center; 
            text-align: center; padding: 24px; 
        }
        @media (max-width: 768px) or (orientation: portrait) { #mobile-warning { display: flex; } }

        @keyframes phoneBounce {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        .phone-icon { animation: phoneBounce 1.5s infinite ease-in-out; }

        /* --- SOL PANEL --- */
        aside { 
            width: 340px; flex-shrink: 0; background: var(--bg-panel); 
            border-right: 1px solid var(--border); padding: 24px; 
            display: flex; flex-direction: column; gap: 20px; 
            z-index: 20; box-shadow: 4px 0 20px rgba(0,0,0,0.03);
            overflow-y: auto;
        }

        .section-title {
            font-size: 0.7rem; font-weight: 800; color: var(--text-muted);
            text-transform: uppercase; letter-spacing: 1px;
            margin-bottom: 8px; border-bottom: 1px solid var(--border); padding-bottom: 4px;
        }

        .control-group { background: #f8fafc; padding: 16px; border-radius: var(--radius); border: 1px solid var(--border); }
        .prop-row { display: flex; flex-direction: column; gap: 4px; margin-bottom: 15px; font-size: 0.8rem; font-weight: 700; }
        .prop-row:last-child { margin-bottom: 0; }
        .label-val { display: flex; justify-content: space-between; align-items: center; }
        .val-badge { font-family: 'JetBrains Mono'; font-weight: 800; color: white; font-size: 0.85rem; background: var(--col-accent); padding: 4px 10px; border-radius: 8px; box-shadow: 0 4px 10px rgba(249, 115, 22, 0.3); }
        
        input[type="range"] { width: 100%; height: 6px; background: #e2e8f0; border-radius: 4px; appearance: none; cursor: pointer; margin-top: 6px; }
        input[type=range]::-webkit-slider-thumb { appearance: none; width: 20px; height: 20px; background: white; border: 4px solid var(--col-accent); border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.1s; }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.15); }

        .info-row { display: flex; justify-content: space-between; font-size: 0.8rem; font-weight: 600; color: #64748b; margin-bottom: 8px; border-bottom: 1px dashed #e2e8f0; padding-bottom: 6px; }
        .info-row:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .info-val { font-weight: 800; color: var(--text-main); font-family: 'Inter', sans-serif; }

        /* --- SAĞ PANEL --- */
        main { flex: 1; position: relative; background: #ffffff; overflow: hidden; }
        canvas { display: block; width: 100%; height: 100%; position: absolute; z-index: 10; }

        /* Veri Kartı HUD */
        .data-card {
            position: absolute; top: 20px; right: 20px; z-index: 20;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(8px);
            padding: 20px; border-radius: var(--radius); border: 1px solid var(--border);
            min-width: 240px; box-shadow: 0 10px 25px -5px rgba(0,0,0,0.05); pointer-events: none;
        }

        /* Lejant */
        .legend-overlay {
            position: absolute; bottom: 20px; right: 20px; z-index: 20;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(5px);
            border: 1px solid var(--border); border-radius: 12px; padding: 12px 16px;
            display: flex; gap: 16px; pointer-events: none; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }
        .leg-item { display: flex; align-items: center; gap: 6px; font-size: 0.75rem; font-weight: 700; color: #475569; }
        .dot { width: 12px; height: 12px; border-radius: 50%; box-shadow: inset -2px -2px 4px rgba(0,0,0,0.2); }
        .line-icon { width: 16px; height: 3px; border-radius: 2px; }
    </style>
</head>
<body>

<div id="mobile-warning">
    <div class="phone-icon mb-6">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
        </svg>
    </div>
    <h2 class="text-2xl font-bold mb-2">Yatay Konuma Geçin</h2>
    <p class="text-slate-400 text-sm max-w-xs">Kartezyen koordinat sistemini tam görebilmek için cihazınızı yan çevirin.</p>
</div>

<aside>
    <div class="flex items-center gap-3 mb-4">
        <a href="../../dersler/matematik.html" class="p-2 hover:bg-orange-100 rounded-full text-orange-600 transition">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
        </a>
        <h1 class="font-bold text-xl text-slate-800">Doğrusal Denklemler</h1>
    </div>

    <div class="section-title">Denklem Parametreleri</div>
    <div class="control-group">
        <div class="prop-row">
            <div class="label-val"><span>Eğim (m)</span><span id="uiM" class="val-badge">2</span></div>
            <input type="range" id="slM" min="-5" max="5" step="0.5" value="2" oninput="sim.setTargetM(this.value)">
        </div>
        <div class="prop-row mt-4">
            <div class="label-val"><span>Y-Kesişim Sabiti (b)</span><span id="uiB" class="val-badge">1</span></div>
            <input type="range" id="slB" min="-8" max="8" step="1" value="1" oninput="sim.setTargetB(this.value)">
        </div>
    </div>

    <div class="section-title">Matematiksel Analiz</div>
    <div class="control-group">
        <div class="info-row"><span>Doğru Yönü:</span><span class="info-val text-blue-500" id="uiDir">Artan</span></div>
        <div class="info-row"><span>Kök (X-Kesişim):</span><span class="info-val text-red-500" id="uiRoot">-0.5</span></div>
    </div>

    <div class="mt-auto p-4 bg-orange-50 border border-orange-100 rounded-xl">
        <p class="text-[10px] font-extrabold text-orange-500 uppercase mb-1">Eğim Üçgeni</p>
        <p class="text-[11px] text-slate-700 leading-relaxed">Mor kesikli çizgiler eğimi temsil eder. 1 birim sağa gidildiğinde doğrunun dikey eksende ne kadar (m) hareket ettiğini gösterir.</p>
    </div>

    <button class="w-full py-3 mt-4 bg-slate-800 text-white rounded-xl font-bold text-xs hover:bg-slate-700 transition" onclick="sim.reset()">SİSTEMİ SIFIRLA</button>
</aside>

<main id="container">
    <div class="data-card">
        <div class="text-[10px] font-extrabold text-slate-400 uppercase mb-3 border-b border-slate-100 pb-2">Canlı Grafik Verisi</div>
        <div class="text-xs text-slate-500 mb-1">Standart Form:</div>
        <div id="hudEq" class="font-mono text-2xl font-bold text-slate-900 mb-4 tracking-tight">y = 2x + 1</div>
        
        <div class="flex justify-between items-center text-xs mb-2 gap-4">
            <span class="text-slate-500">Y-Eksenini Keser:</span>
            <span id="hudYInt" class="font-mono font-bold text-amber-500 text-sm">(0, 1)</span>
        </div>
        <div class="flex justify-between items-center text-xs gap-4">
            <span class="text-slate-500">X-Eksenini Keser:</span>
            <span id="hudXInt" class="font-mono font-bold text-red-500 text-sm">(-0.5, 0)</span>
        </div>
    </div>

    <canvas id="simCanvas"></canvas>

    <div class="legend-overlay">
        <div class="leg-item"><div class="line-icon" style="background: var(--col-line);"></div> f(x) Doğrusu</div>
        <div class="leg-item"><div class="line-icon border border-dashed border-purple-500 bg-transparent h-0"></div> Eğim (m)</div>
        <div class="leg-item"><div class="dot" style="background: var(--col-yint);"></div> b Sabiti</div>
    </div>
</main>

<script>
const sim = {
    canvas: document.getElementById('simCanvas'),
    ctx: null, w: 0, h: 0,
    
    // Akıcı animasyon için hedef ve mevcut değerler
    targetM: 2, m: 2,
    targetB: 1, b: 1,
    
    scale: 40, // 1 birim = 40px
    offsetX: 0, offsetY: 0,

    init() {
        this.ctx = this.canvas.getContext('2d');
        this.resize();
        window.addEventListener('resize', () => this.resize());
        this.updateUI();
        requestAnimationFrame(() => this.loop());
    },

    resize() {
        const el = document.getElementById('container');
        const dpr = window.devicePixelRatio || 1;
        this.w = el.clientWidth; this.h = el.clientHeight;
        this.canvas.width = this.w * dpr; this.canvas.height = this.h * dpr;
        this.ctx.scale(dpr, dpr);
        
        this.offsetX = this.w / 2;
        this.offsetY = this.h / 2;
    },

    reset() {
        document.getElementById('slM').value = 2;
        document.getElementById('slB').value = 1;
        this.setTargetM(2);
        this.setTargetB(1);
    },

    setTargetM(val) { this.targetM = parseFloat(val); this.updateUI(); },
    setTargetB(val) { this.targetB = parseFloat(val); this.updateUI(); },

    updateUI() {
        // Sol Panel Güncellemesi
        document.getElementById('uiM').innerText = this.targetM;
        document.getElementById('uiB').innerText = this.targetB;

        let dir = "Sabit"; let dirColor = "text-slate-500";
        if (this.targetM > 0) { dir = "Artan ↗"; dirColor = "text-blue-500"; }
        else if (this.targetM < 0) { dir = "Azalan ↘"; dirColor = "text-red-500"; }
        
        document.getElementById('uiDir').innerText = dir;
        document.getElementById('uiDir').className = `info-val ${dirColor}`;

        // HUD Formül Oluşturma
        let mStr = "";
        if (this.targetM === 1) mStr = "x";
        else if (this.targetM === -1) mStr = "-x";
        else if (this.targetM !== 0) mStr = `${this.targetM}x`;

        let bStr = "";
        if (this.targetB > 0) bStr = this.targetM === 0 ? `${this.targetB}` : ` + ${this.targetB}`;
        else if (this.targetB < 0) bStr = ` - ${Math.abs(this.targetB)}`;
        else if (this.targetM === 0 && this.targetB === 0) bStr = "0";

        let eq = `y = ${mStr}${bStr}`;
        if (this.targetM === 0 && this.targetB === 0) eq = "y = 0";
        document.getElementById('hudEq').innerText = eq;

        // Kesişim Noktaları
        document.getElementById('hudYInt').innerText = `(0, ${this.targetB})`;
        
        if (this.targetM !== 0) {
            let root = -this.targetB / this.targetM;
            root = Number.isInteger(root) ? root : root.toFixed(2);
            document.getElementById('hudXInt').innerText = `(${root}, 0)`;
            document.getElementById('uiRoot').innerText = root;
        } else {
            document.getElementById('hudXInt').innerText = "Yok";
            document.getElementById('uiRoot').innerText = "Tanımsız";
        }
    },

    toCanvasX(x) { return this.offsetX + (x * this.scale); },
    toCanvasY(y) { return this.offsetY - (y * this.scale); },

    drawGrid() {
        const ctx = this.ctx;
        ctx.strokeStyle = "#e2e8f0";
        ctx.lineWidth = 1;

        // Dikey Izgaralar
        for(let x = this.offsetX % this.scale; x < this.w; x += this.scale) {
            ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, this.h); ctx.stroke();
        }
        // Yatay Izgaralar
        for(let y = this.offsetY % this.scale; y < this.h; y += this.scale) {
            ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(this.w, y); ctx.stroke();
        }

        // Ana Eksenler
        ctx.strokeStyle = "#94a3b8"; ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(0, this.offsetY); ctx.lineTo(this.w, this.offsetY);
        ctx.moveTo(this.offsetX, 0); ctx.lineTo(this.offsetX, this.h);
        ctx.stroke();

        // Rakamlar
        ctx.fillStyle = "#64748b"; ctx.font = "600 10px Inter"; ctx.textAlign="center"; ctx.textBaseline="middle";
        for(let i = -15; i <= 15; i++) {
            if(i === 0) continue;
            // X Eksen
            ctx.fillText(i, this.toCanvasX(i), this.offsetY + 14);
            // Y Eksen
            ctx.fillText(i, this.offsetX - 14, this.toCanvasY(i));
        }
    },

    drawLine() {
        const ctx = this.ctx;
        const minX = -30; const maxX = 30;
        const y1 = this.m * minX + this.b;
        const y2 = this.m * maxX + this.b;

        ctx.strokeStyle = "#3b82f6"; // Teorim vurgu mavisi
        ctx.lineWidth = 4; ctx.lineCap = "round";
        ctx.beginPath();
        ctx.moveTo(this.toCanvasX(minX), this.toCanvasY(y1));
        ctx.lineTo(this.toCanvasX(maxX), this.toCanvasY(y2));
        ctx.stroke();
    },

    drawTriangle() {
        const ctx = this.ctx;
        const px1 = this.toCanvasX(0); const py1 = this.toCanvasY(this.b);
        const px2 = this.toCanvasX(1); const py2 = this.toCanvasY(this.b + this.m);

        ctx.strokeStyle = "#a855f7"; ctx.lineWidth = 2.5; ctx.setLineDash([5, 5]);
        
        // Yatay (Run = 1)
        ctx.beginPath(); ctx.moveTo(px1, py1); ctx.lineTo(px2, py1); ctx.stroke();
        // Dikey (Rise = m)
        ctx.beginPath(); ctx.moveTo(px2, py1); ctx.lineTo(px2, py2); ctx.stroke();
        
        ctx.setLineDash([]);

        ctx.fillStyle = "#a855f7"; ctx.font = "800 12px Inter";
        ctx.textAlign = "center"; ctx.fillText("1", (px1 + px2)/2, py1 + (this.m > 0 ? 16 : -8));
        ctx.textAlign = "left"; ctx.fillText(`m=${this.m.toFixed(1).replace('.0','')}`, px2 + 8, (py1 + py2)/2);
    },

    drawPoints() {
        const ctx = this.ctx;
        
        // Y-Kesişim (0, b)
        const py = this.toCanvasY(this.b);
        const px = this.toCanvasX(0);
        ctx.fillStyle = "#f59e0b"; ctx.beginPath(); ctx.arc(px, py, 6, 0, Math.PI*2); ctx.fill();
        ctx.strokeStyle = "white"; ctx.lineWidth = 2; ctx.stroke();

        // X-Kesişim
        if (Math.abs(this.m) > 0.01) {
            const rx = this.toCanvasX(-this.b / this.m);
            const ry = this.toCanvasY(0);
            ctx.fillStyle = "#ef4444"; ctx.beginPath(); ctx.arc(rx, ry, 6, 0, Math.PI*2); ctx.fill();
            ctx.stroke();
        }
    },

    loop() {
        // Akıcı Değer Geçişi (Lerp)
        this.m += (this.targetM - this.m) * 0.15;
        this.b += (this.targetB - this.b) * 0.15;

        this.ctx.clearRect(0, 0, this.w, this.h);
        
        this.drawGrid();
        this.drawLine();
        this.drawTriangle();
        this.drawPoints();

        requestAnimationFrame(() => this.loop());
    }
};

window.addEventListener('load', () => sim.init());
</script>
</body>
</html>

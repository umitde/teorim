<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cebir İnşaat | Teorim</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-app: #f8fafc;
            --bg-panel: #ffffff;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --col-accent: #f97316; /* TEORİM TURUNCUSU */
            
            /* Matematiksel Karo Renkleri (Canvas için sabit kalacak) */
            --col-x2: #3b82f6;     /* x² - Mavi */
            --col-x: #10b981;      /* x - Yeşil */
            --col-1: #f59e0b;      /* 1 - Kehribar */
            --col-err: #ef4444;    /* Hata */
            
            --border: #e2e8f0;
            --radius: 16px;
        }

        body { 
            margin: 0; padding: 0; background: var(--bg-app); 
            color: var(--text-main); font-family: 'Inter', sans-serif; 
            height: 100vh; display: flex; overflow: hidden; 
            -webkit-font-smoothing: antialiased;
        }

        /* --- MOBİL UYARI --- */
        #mobile-warning { 
            display: none; position: fixed; inset: 0; background: #0f172a; color: white; 
            z-index: 9999; flex-direction: column; align-items: center; justify-content: center; 
            text-align: center; padding: 24px; 
        }
        @media (max-width: 768px) or (orientation: portrait) { #mobile-warning { display: flex; } }

        @keyframes phoneBounce {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        .phone-icon { animation: phoneBounce 1.5s infinite ease-in-out; }

        /* --- SOL PANEL --- */
        aside { 
            width: 340px; flex-shrink: 0; background: var(--bg-panel); 
            border-right: 1px solid var(--border); padding: 24px; 
            display: flex; flex-direction: column; gap: 20px; 
            z-index: 20; box-shadow: 4px 0 20px rgba(0,0,0,0.03);
            overflow-y: auto;
        }

        .section-title {
            font-size: 0.7rem; font-weight: 800; color: var(--text-muted);
            text-transform: uppercase; letter-spacing: 1px;
            margin-bottom: 8px; border-bottom: 1px solid var(--border); padding-bottom: 4px;
        }

        .control-group { background: #f8fafc; padding: 16px; border-radius: var(--radius); border: 1px solid var(--border); }
        .prop-row { display: flex; flex-direction: column; gap: 4px; margin-bottom: 15px; font-size: 0.8rem; font-weight: 700; }
        .prop-row:last-child { margin-bottom: 0; }
        .label-val { display: flex; justify-content: space-between; align-items: center; }
        
        /* UI Kontrolleri için Ana Tema Rengi Kullanımı */
        .val-badge { font-family: 'JetBrains Mono'; font-weight: 800; color: white; font-size: 0.85rem; padding: 4px 10px; border-radius: 8px; background: var(--col-accent); box-shadow: 0 2px 5px rgba(249, 115, 22, 0.3); }
        
        input[type="range"] { width: 100%; height: 6px; background: #e2e8f0; border-radius: 4px; appearance: none; cursor: pointer; margin-top: 6px; }
        input[type=range]::-webkit-slider-thumb { appearance: none; width: 20px; height: 20px; background: white; border: 4px solid var(--col-accent); border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.1s; }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.15); }

        /* --- SAĞ PANEL --- */
        main { flex: 1; position: relative; background: #ffffff; overflow: hidden; }
        main::before {
            content: ''; position: absolute; inset: 0;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 30px 30px; opacity: 0.5; pointer-events: none;
        }
        canvas { display: block; width: 100%; height: 100%; position: absolute; z-index: 10; }

        /* Veri Kartı */
        .data-card {
            position: absolute; top: 20px; right: 20px; z-index: 20;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(5px);
            padding: 18px 24px; border-radius: var(--radius); border: 1px solid var(--border);
            min-width: 260px; box-shadow: 0 10px 30px -5px rgba(0,0,0,0.08); pointer-events: none;
        }

        /* Lejant */
        .legend-overlay {
            position: absolute; bottom: 20px; right: 20px; z-index: 20;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(5px);
            border: 1px solid var(--border); border-radius: 12px; padding: 12px 16px;
            display: flex; gap: 16px; pointer-events: none; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }
        .leg-item { display: flex; align-items: center; gap: 6px; font-size: 0.75rem; font-weight: 700; color: #475569; }
        .box-icon { width: 14px; height: 14px; border-radius: 3px; box-shadow: inset -2px -2px 4px rgba(0,0,0,0.15); }
    </style>
</head>
<body>

<div id="mobile-warning">
    <div class="phone-icon mb-6">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
        </svg>
    </div>
    <h2 class="text-2xl font-bold mb-2">Yatay Konuma Geçin</h2>
    <p class="text-slate-400 text-sm max-w-xs">Cebir karolarını yerleştirebilmek için cihazınızı yan çevirin.</p>
</div>

<aside>
    <div class="flex items-center gap-3 mb-4">
        <a href="../../dersler/matematik.html" class="p-2 hover:bg-orange-100 rounded-full text-orange-600 transition">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
        </a>
        <h1 class="font-bold text-xl text-slate-800">Çarpanlara Ayırma</h1>
    </div>

    <div class="section-title">Denklem Parametreleri</div>
    <div class="control-group">
        <div class="prop-row">
            <div class="label-val">
                <span>x Katsayısı (b)</span>
                <span id="uiB" class="val-badge">5</span>
            </div>
            <input type="range" id="slB" min="2" max="10" value="5" oninput="sim.update(this.value, sim.c)">
        </div>
        <div class="prop-row mt-4">
            <div class="label-val">
                <span>Sabit Sayı (c)</span>
                <span id="uiC" class="val-badge">6</span>
            </div>
            <input type="range" id="slC" min="1" max="16" value="6" oninput="sim.update(sim.b, this.value)">
        </div>
    </div>

    <div class="mt-auto p-4 bg-orange-50 border border-orange-100 rounded-xl">
        <p class="text-[10px] font-extrabold text-orange-500 uppercase mb-1">Teorem Notu</p>
        <p class="text-[11px] text-slate-700 leading-relaxed">Cebirsel ifade parçalara ayrılır. Eğer bu parçalarla kusursuz bir dikdörtgen oluşturulabilirse, kenar uzunlukları çarpanları verir.</p>
    </div>

    <button class="w-full py-3 bg-slate-800 text-white rounded-xl font-bold text-xs hover:bg-slate-700 transition" onclick="sim.reset()">SİSTEMİ SIFIRLA</button>
</aside>

<main id="container">
    <div class="data-card">
        <div class="text-[10px] font-extrabold text-slate-400 uppercase mb-3 border-b border-slate-100 pb-2">Denklem Analizi</div>
        <div class="text-xs text-slate-500 mb-1">Cebirsel İfade:</div>
        <div id="hudEq" class="font-mono text-xl font-bold text-slate-900 mb-3 tracking-wide">x² + 5x + 6</div>
        
        <div class="text-xs text-slate-500 mb-1">Çarpanlar:</div>
        <div id="hudFactor" class="font-mono text-lg font-bold text-emerald-500">(x + 2)(x + 3)</div>
        
        <div id="hudStatus" class="mt-3 text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded bg-emerald-100 text-emerald-700 inline-block">
            Dikdörtgen Tamamlandı
        </div>
    </div>

    <canvas id="simCanvas"></canvas>

    <div class="legend-overlay">
        <div class="leg-item"><div class="box-icon" style="background: var(--col-x2);"></div> x² Birimi</div>
        <div class="leg-item"><div class="box-icon" style="background: var(--col-x);"></div> x Birimi</div>
        <div class="leg-item"><div class="box-icon" style="background: var(--col-1);"></div> 1 Birimi</div>
    </div>
</main>

<script>
const sim = {
    canvas: document.getElementById('simCanvas'),
    ctx: null, w: 0, h: 0,
    
    b: 5, c: 6,
    factors: [2, 3],
    time: 0, isValid: true,

    TILE_SIZE: 40,
    X_LENGTH: 120,
    
    colors: {
        x2: '#3b82f6', x: '#10b981', one: '#f59e0b', error: '#ef4444'
    },

    init() {
        this.ctx = this.canvas.getContext('2d');
        this.resize();
        window.addEventListener('resize', () => this.resize());
        this.update(5, 6);
        requestAnimationFrame((t) => this.loop(t));
    },

    resize() {
        const el = document.getElementById('container');
        const dpr = window.devicePixelRatio || 1;
        this.w = el.clientWidth; this.h = el.clientHeight;
        this.canvas.width = this.w * dpr; this.canvas.height = this.h * dpr;
        this.ctx.scale(dpr, dpr);
    },

    reset() {
        document.getElementById('slB').value = 5;
        document.getElementById('slC').value = 6;
        this.update(5, 6);
    },

    update(valB, valC) {
        this.b = parseInt(valB);
        this.c = parseInt(valC);
        this.time = 0;

        this.factors = this.solveFactors(this.b, this.c);
        this.isValid = (this.factors !== null);

        document.getElementById('uiB').innerText = this.b;
        document.getElementById('uiC').innerText = this.c;
        document.getElementById('hudEq').innerText = `x² + ${this.b}x + ${this.c}`;

        const resDiv = document.getElementById('hudFactor');
        const statusDiv = document.getElementById('hudStatus');

        if (this.isValid) {
            resDiv.innerText = `(x + ${this.factors[0]})(x + ${this.factors[1]})`;
            resDiv.className = "font-mono text-lg font-bold text-emerald-500";
            statusDiv.innerText = "DİKDÖRTGEN TAMAMLANDI";
            statusDiv.className = "mt-3 text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded bg-emerald-100 text-emerald-700 inline-block";
        } else {
            resDiv.innerText = "Ayrılamıyor";
            resDiv.className = "font-mono text-lg font-bold text-rose-500";
            statusDiv.innerText = "PARÇALAR UYUŞMUYOR";
            statusDiv.className = "mt-3 text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded bg-rose-100 text-rose-700 inline-block";
        }
    },

    solveFactors(b, c) {
        for (let i = 1; i <= Math.sqrt(c) + 1; i++) {
            if (c % i === 0) {
                let j = c / i;
                if (i + j === b) return [i, j].sort();
            }
        }
        return null;
    },

    drawTile(x, y, w, h, color, text, alpha) {
        const ctx = this.ctx;
        ctx.save();
        ctx.globalAlpha = alpha;
        
        let scale = alpha < 1 ? 0.8 + (alpha * 0.2) : 1;
        const cx = x + w/2; const cy = y + h/2;
        ctx.translate(cx, cy); ctx.scale(scale, scale); ctx.translate(-cx, -cy);

        ctx.fillStyle = color;
        ctx.shadowColor = "rgba(0,0,0,0.15)"; ctx.shadowBlur = 10; ctx.shadowOffsetY = 4;
        
        ctx.beginPath(); ctx.roundRect(x + 2, y + 2, w - 4, h - 4, 8); ctx.fill();
        ctx.shadowBlur = 0; ctx.shadowOffsetY = 0;

        ctx.strokeStyle = "rgba(255,255,255,0.4)"; ctx.lineWidth = 2; ctx.stroke();

        if (w > 20 && h > 20) {
            ctx.fillStyle = "white";
            ctx.font = "bold 16px Inter"; ctx.textAlign = "center"; ctx.textBaseline = "middle";
            ctx.fillText(text, x + w/2, y + h/2);
        }
        ctx.restore();
    },

    drawDimension(x, y, len1, len2, text, type) {
        const ctx = this.ctx;
        ctx.fillStyle = "#334155";
        ctx.font = "bold 18px Inter";
        
        if (type === 'horizontal') {
            ctx.beginPath(); ctx.strokeStyle = "#94a3b8"; ctx.lineWidth = 2;
            ctx.moveTo(x, y); ctx.lineTo(x + len1 + len2, y);
            ctx.moveTo(x, y-5); ctx.lineTo(x, y+5);
            ctx.moveTo(x + len1, y-3); ctx.lineTo(x + len1, y+3);
            ctx.moveTo(x + len1 + len2, y-5); ctx.lineTo(x + len1 + len2, y+5);
            ctx.stroke();
            ctx.textAlign = "center"; ctx.textBaseline = "bottom";
            ctx.fillText(text, x + (len1 + len2)/2, y - 8);
        } else {
            ctx.beginPath(); ctx.strokeStyle = "#94a3b8"; ctx.lineWidth = 2;
            ctx.moveTo(x, y); ctx.lineTo(x, y + len1 + len2);
            ctx.moveTo(x-5, y); ctx.lineTo(x+5, y); 
            ctx.moveTo(x-3, y + len1); ctx.lineTo(x+3, y + len1);
            ctx.moveTo(x-5, y + len1 + len2); ctx.lineTo(x+5, y + len1 + len2);
            ctx.stroke();
            ctx.save(); ctx.translate(x - 12, y + (len1 + len2)/2); ctx.rotate(-Math.PI / 2);
            ctx.textAlign = "center"; ctx.textBaseline = "bottom"; ctx.fillText(text, 0, 0); ctx.restore();
        }
    },

    drawScattered() {
        const ctx = this.ctx;
        const startX = this.w/2 - 60; const startY = this.h/2;
        
        this.drawTile(startX, startY, this.X_LENGTH, this.X_LENGTH, "#cbd5e1", "x²", 1);
        ctx.fillStyle = this.colors.error; ctx.font = "bold 24px Inter"; ctx.textAlign = "center";
        ctx.fillText("?", startX + this.X_LENGTH + 30, startY + 60);
    },

    loop() {
        this.ctx.clearRect(0, 0, this.w, this.h);
        this.time += 0.04;
        
        if (!this.isValid) { this.drawScattered(); }
        else {
            const [m, n] = this.factors;
            const totalW = this.X_LENGTH + (n * this.TILE_SIZE);
            const totalH = this.X_LENGTH + (m * this.TILE_SIZE);
            const startX = (this.w - totalW) / 2; const startY = (this.h - totalH) / 2;

            if (this.time > 0) this.drawTile(startX, startY, this.X_LENGTH, this.X_LENGTH, this.colors.x2, "x²", Math.min(1, this.time * 2));

            for (let i = 0; i < n; i++) {
                const delay = 0.5 + (i * 0.1);
                if (this.time > delay) this.drawTile(startX + this.X_LENGTH + (i * this.TILE_SIZE), startY, this.TILE_SIZE, this.X_LENGTH, this.colors.x, "x", Math.min(1, (this.time - delay) * 2));
            }

            for (let i = 0; i < m; i++) {
                const delay = 1.0 + (i * 0.1);
                if (this.time > delay) this.drawTile(startX, startY + this.X_LENGTH + (i * this.TILE_SIZE), this.X_LENGTH, this.TILE_SIZE, this.colors.x, "x", Math.min(1, (this.time - delay) * 2));
            }

            for (let i = 0; i < n; i++) {
                for (let j = 0; j < m; j++) {
                    const delay = 1.5 + ((i + j) * 0.05);
                    if (this.time > delay) this.drawTile(startX + this.X_LENGTH + (i * this.TILE_SIZE), startY + this.X_LENGTH + (j * this.TILE_SIZE), this.TILE_SIZE, this.TILE_SIZE, this.colors.one, "1", Math.min(1, (this.time - delay) * 2));
                }
            }

            if (this.time > 2.5) {
                this.ctx.globalAlpha = Math.min(1, (this.time - 2.5));
                this.drawDimension(startX, startY - 20, this.X_LENGTH, n * this.TILE_SIZE, `x + ${n}`, 'horizontal');
                this.drawDimension(startX - 20, startY, this.X_LENGTH, m * this.TILE_SIZE, `x + ${m}`, 'vertical');
                this.ctx.globalAlpha = 1;
            }
        }
        requestAnimationFrame(() => this.loop());
    }
};

window.addEventListener('load', () => sim.init());
</script>
</body>
</html>
